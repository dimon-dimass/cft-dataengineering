# Data Engineer CFT Тестовое задание

## Структура проекта

- **etl/__init__.py**.
- **etl/extract.py**: Модуль содержащий функции по извлечению API данных.
- **etl/load.py**: Модуль содержащий функции выгрузки обработанных данных.
- **etl/test.py**: Модуль для тестов программы.
- **etl/transform.py**: Модуль содержащий класс, методы и функции, трансформирующие данные.
- **docker-compose.yaml**: Docker-compose файл, предназначенный для поднятия PostgresSQL контейнера и создания БД.
- **init.sql**: Скрипт создания схемы и таблиц.
- **main.py**: Основная функция, запускающая ETL-пайплайн.
- **requirement.txt**: Файл для установки зависимостей (бибилотек и пакетов). 

## Установка необходимых компонентов

- **Docker/Docker desktop** - Проследовать инструкции по установке и запуску по ссылке: https://docs.docker.com/get-started/get-docker/.
- **Python** - Скачать и установить python пакет по ссылке: https://www.python.org/downloads/.

## Как пользоваться программой

### 1. Поднятие Docker контейнера

После успешной [установки Docker'а](#Установка) необходимо выполнить следующую последовательность действий в *bash*:
```bash
cd project_dir/
docker compose up -d
```

### 2. Запуск программы

Чтобы запустить программу необходимо выполнить предварительную настройку зависимостей проекта (рекомендую использовать виртуальную среду py):
```bash
pip install -r requirements.txt
```
и после успешной установики зависимостей можем запускать основное приложение:

```python
python main.py --start_date --end_date --file_path --conflict_resolve
--start_date, -sdt      Начальная дата интервала запроса (по умолчанию: 2025-05-16)
--end_date, -edt      Крайняя дата интервала запроса (по умолчанию: 2025-05-30)
--file_path      Путь для сохранения CSV-файлов (по умолчанию: ['res/daily.csv', 'res/hourly.csv'])
--conflict_resolve      Способ борьбы с дубликатами записей при выгрузке в БД (по умолчанию: 'NOTHING')
                        Варианты:
                        - 'NOTHING' - игнорирование дублирующий по ключу записей,
                        - 'UPDATE' - обновление дублирующий по ключу записей  
```
### 3. Результат программы

Результатом работы программы будет являться два текстовый файла (.csv), лежищих по пути 'project_dir/res/', и заполненные таблицы daily и hourly схемы nsk_plus_7gt БД 
